<!DOCTYPE html>
<html>
<head>

<title> User profile </title>
<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="./js/jquery_session.js">
</script>

<script>
	if(sessionStorage.getItem('auth_token') == null){
		window.location.replace("/login");
	}
</script>

<script type="text/javascript">

function updateList(items) {
    /*$("#my-list").html("");
    var i = 0;
    items.forEach(function (e) {
        $("#my-list").append("<li>" + i + ". From: " + e.from + " to: " + e.to + "<br> Wagon: " + e.wagonnumber + ", Place: " + e.place + "<br> Price: " + e.price + ". Seat type: " + e.seattype + "</li>");
        i++;
    });*/
	$("#my-list").html("");
	var i = 0;
    items.data.forEach(function (e) {
        $("#my-list").append("<li>" + i + ". Train: " + e.Train_ID + " Place: " + e.place + "<br> Price: " + e.price + ", Seat type: " + e.seat_type + " Date: " + e.date + "</li>");
        i++;
    });
	
}

function getListItems() {
    /*$.ajax({
        type: "POST",
        url : '/passenger/tickets',
		data: 
		{
			login: $("#login").val(),
		},
        success : function(r) {
            updateList(r);
        }
        dataType : 'json',
		error: [""]
    });
	$.ajax({
		url: "https://reqres.in/api/users",
		type: "POST",
		data: {
			name: "paul rudd",
			movies: ["I Love You Man", "Role Models"]
		},
		success: function(response){
			console.log(response);
		}
	});
	*/
	$.ajax({
		url: "http://localhost:8080/dynamictodolist_war_exploded/services/passenger/tickets",
		type: "GET",
		dataType: "application/json",
		headers: {
			"Authorization" : "Bearer " + sessionStorage.getItem('auth_token')
		},
		success: function(response){
			updateList(response);
		},
		error: function(jQxhr, textStatus, errorThorwn) {
			console.log(errorThorwn);
		}
	});
	/*$.ajax({
		type: 'post',
		url : 'http://localhost:8080/dynamictodolist_war_exploded/services/login',
		contentType: 'application/x-www-form-urlencoded',
		data: 
		{
			login: $("#login").val(),
			password: $("#password").val()
			fname: $("#fname").val()
			lname: $("#lname").val()
			email: $("#email").val()
		},
		success : function(r) {

		//go to next page
		$.session.set("auth_token", r.token);
		var token = $.session.get("auth_token");
		console.log(token);
		},
		crossDomain : true,
		dataType : 'json',
		error: function(jQxhr, textStatus, errorThorwn) {
			console.log(errorThorwn);
		}
	});	*/
    
}

$(document).ready(function () { 
	getListItems(); 
});    
</script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> 
<link rel="stylesheet" href="./css/style.css"> 

</head>
<body>
    <nav class="navbar navbar-expand-md navbar-light bg-light fixed-top" style="height: 80px;">
            <div class="navbar-collapse collapse w-100 order-1 dual-collapse2">
                <a class="navbar-brand" href = "/">
                    <img src="./assets/logoMain.png" alt=""  class = "ml-5 fixed-top" style="height: 80px; object-fit: contain;">    
                </a>
            </div>
            <div class="navbar-collapse collapse w-100 order-2 dual-collapse2" id="myNavbar">
                <ul class = "navbar-nav ml-auto">
                    <li class = "nav-item mx-5">
                        <a href = "/profile" class = "nav-link menu-item nav-active">
                            My Tickets
                        </a>
                    </li>
                    <li class = "nav-item mx-4">
                        <button class = "nav-link logout" id = "logout-btn">
                            Log Out
                        </button>
                    </li>  
                </ul>
                
            </div>
        </nav>
<h1> Nur Akhmetov </h1>
<hr>
<h2> Tickets: </h2>
<!-- the list of tickets of passenger 
If login, then user.getTickets()
print
get Name
-->
<!-- 
Table,
book. Name(first_name+second_name), destination, destination_time
-->
<ul id="my-list"></ul>
</body>
<<<<<<< HEAD
<script src="./js/jquery-3.4.1.js"></script>
<script src="./js/jquery_session.js"></script>
<script src="./js/global.js"></script>
</html>
=======
</html>
>>>>>>> cb8f933a9e30d32f619c25a549eb3f0d4afe4624
